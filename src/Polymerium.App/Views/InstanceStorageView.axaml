<controls:Subpage xmlns="https://github.com/avaloniaui"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:husk="https://github.com/d3ara1n/Huskui.Avalonia"
                  xmlns:controls="using:Polymerium.App.Controls"
                  xmlns:vm="using:Polymerium.App.ViewModels"
                  xmlns:icons="https://github.com/MahApps/IconPacks.Avalonia"
                  xmlns:fi="using:FluentIcons.Avalonia"
                  xmlns:converters="clr-namespace:Polymerium.App.Converters"
                  xmlns:v="clr-namespace:Polymerium.App.Views"
                  mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
                  x:Class="Polymerium.App.Views.InstanceStorageView"
                  x:DataType="vm:InstanceStorageViewModel">
    <Grid RowDefinitions="Auto,Auto,*" RowSpacing="12">
        <!-- 总览区域 -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
            <StackPanel Grid.Column="0" Spacing="4">
                <husk:Tag Content="Total Instance Size" />
                <TextBlock>
                    <Run
                        Text="{Binding TotalSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToGiBDoubleConverter},FallbackValue=0.00}"
                        FontSize="36" FontWeight="{StaticResource ControlStrongFontWeight}" />
                    <Run Text="GiB" FontSize="18" />
                </TextBlock>
            </StackPanel>
            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button Theme="{StaticResource OutlineButtonTheme}" VerticalAlignment="Center"
                        Classes="Small"
                        Command="{Binding OpenInstanceFolderCommand}">
                    <husk:IconLabel Icon="FolderOpen" Text="Open Folder" />
                </Button>
                <Button Theme="{StaticResource OutlineButtonTheme}" VerticalAlignment="Center"
                        Classes="Small"
                        Command="{Binding $parent[v:InstanceView].NavigateCommand}"
                        CommandParameter="{x:Type v:InstanceAssetsView}">
                    <husk:IconLabel Icon="Library" Text="Go to Resource Explorer" />
                </Button>
            </StackPanel>
        </Grid>

        <!-- 主要存储分类 -->
        <StackPanel Grid.Row="1" Spacing="4">
            <TextBlock Text="Breakdown" FontSize="{StaticResource LargeFontSize}"
                       FontWeight="{StaticResource ControlStrongFontWeight}" />
            <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="12">
                <!-- Mods -->
                <husk:Card Grid.Column="0">
                    <StackPanel Spacing="4">
                        <icons:PackIconLucide Kind="Boxes" Height="{StaticResource ExtraLargeFontSize}"
                                              Width="{StaticResource ExtraLargeFontSize}"
                                              Foreground="{StaticResource ControlAccentForegroundBrush}" />
                        <TextBlock Text="Mods" FontWeight="{StaticResource ControlStrongFontWeight}" />
                        <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}">
                            <fi:SymbolIcon Symbol="Document" FontSize="{StaticResource SmallFontSize}"
                                           HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Run Text="{Binding ModsCount}" />
                            <Run Text="/" />
                            <Run
                                Text="{Binding ModsSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},Mode=OneWay,FallbackValue=0.00}" />
                            <Run Text="MiB" />
                            <Run Text=" / " />
                            <Run Text="{Binding #ModsProgressBar.Percentage,StringFormat={}{0:0.0}%}" />
                        </TextBlock>
                        <ProgressBar Name="ModsProgressBar" Value="{Binding ModsSize}"
                                     Maximum="{Binding TotalSize}" />
                    </StackPanel>
                </husk:Card>

                <!-- Resource Packs -->
                <husk:Card Grid.Column="1">
                    <StackPanel Spacing="4">
                        <icons:PackIconLucide Kind="Package" Height="{StaticResource ExtraLargeFontSize}"
                                              Width="{StaticResource ExtraLargeFontSize}"
                                              Foreground="#9B59B6" />
                        <TextBlock Text="Resource Packs" FontWeight="{StaticResource ControlStrongFontWeight}" />
                        <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}">
                            <fi:SymbolIcon Symbol="Document" FontSize="{StaticResource SmallFontSize}"
                                           HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Run Text="{Binding ResourcePacksCount,Mode=OneWay}" />
                            <Run Text="/" />
                            <Run
                                Text="{Binding ResourcePacksSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},Mode=OneWay,FallbackValue=0.00}" />
                            <Run Text="MiB" />
                            <Run Text=" / " />
                            <Run Text="{Binding #ResourcePacksProgressBar.Percentage,StringFormat={}{0:0.0}%}" />
                        </TextBlock>
                        <ProgressBar Name="ResourcePacksProgressBar" Value="{Binding ResourcePacksSize}"
                                     Maximum="{Binding TotalSize}" />
                    </StackPanel>
                </husk:Card>

                <!-- Shader Packs -->
                <husk:Card Grid.Column="2">
                    <StackPanel Spacing="4">
                        <icons:PackIconLucide Kind="Sparkles" Height="{StaticResource ExtraLargeFontSize}"
                                              Width="{StaticResource ExtraLargeFontSize}"
                                              Foreground="#E67E22" />
                        <TextBlock Text="Shader Packs" FontWeight="{StaticResource ControlStrongFontWeight}" />
                        <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}">
                            <fi:SymbolIcon Symbol="Document" FontSize="{StaticResource SmallFontSize}"
                                           HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Run Text="{Binding ShaderPacksCount,Mode=OneWay}" />
                            <Run Text="/" />
                            <Run
                                Text="{Binding ShaderPacksSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},Mode=OneWay,FallbackValue=0.00}" />
                            <Run Text="MiB" />
                            <Run Text=" / " />
                            <Run Text="{Binding #ShaderPacksProgressBar.Percentage,StringFormat={}{0:0.0}%}" />
                        </TextBlock>
                        <ProgressBar Name="ShaderPacksProgressBar" Value="{Binding ShaderPacksSize}"
                                     Maximum="{Binding TotalSize}" />
                    </StackPanel>
                </husk:Card>

                <!-- Worlds/Saves -->
                <husk:Card Grid.Column="3">
                    <StackPanel Spacing="4">
                        <icons:PackIconLucide Kind="Globe" Height="{StaticResource ExtraLargeFontSize}"
                                              Width="{StaticResource ExtraLargeFontSize}"
                                              Foreground="#27AE60" />
                        <TextBlock Text="Worlds" FontWeight="{StaticResource ControlStrongFontWeight}" />
                        <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}">
                            <fi:SymbolIcon Symbol="Document" FontSize="{StaticResource SmallFontSize}"
                                           HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Run Text="{Binding WorldsCount,Mode=OneWay}" />
                            <Run Text="/" />
                            <Run
                                Text="{Binding WorldsSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},Mode=OneWay,FallbackValue=0.00}" />
                            <Run Text="MiB" />
                            <Run Text=" / " />
                            <Run Text="{Binding #WorldsProgressBar.Percentage,StringFormat={}{0:0.0}%}" />
                        </TextBlock>
                        <ProgressBar Name="WorldsProgressBar" Value="{Binding WorldsSize}"
                                     Maximum="{Binding TotalSize}" />
                    </StackPanel>
                </husk:Card>
            </Grid>
        </StackPanel>

        <!-- 详细存储信息 -->
        <ScrollViewer Grid.Row="2">
            <StackPanel Spacing="12">
                <!-- 其他文件夹 -->
                <StackPanel Spacing="4">
                    <TextBlock Text="Additional" FontSize="{StaticResource LargeFontSize}"
                               FontWeight="{StaticResource ControlStrongFontWeight}" />
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="12" RowDefinitions="Auto,Auto,Auto" RowSpacing="12">
                        <!-- Screenshots -->
                        <husk:Card Grid.Row="0" Grid.Column="0">
                            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                                <icons:PackIconLucide Grid.Column="0" Kind="Image"
                                                      Height="{StaticResource LargeFontSize}"
                                                      Width="{StaticResource LargeFontSize}"
                                                      Foreground="#3498DB" />
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="Screenshots"
                                               FontWeight="{StaticResource ControlStrongFontWeight}" />
                                    <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}"
                                               FontSize="{StaticResource SmallFontSize}">
                                        <Run
                                            Text="{Binding ScreenshotsSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},FallbackValue=0.00}" />
                                        <Run Text="MiB" />
                                        <Run Text="·" />
                                        <Run Text="{Binding ScreenshotsCount,FallbackValue=0}" />
                                        <Run Text="files" />
                                    </TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenBuildFolderCommand}"
                                            CommandParameter="screenshots">
                                        <fi:SymbolIcon Symbol="Folder" FontSize="{StaticResource SmallFontSize}" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenImportFolderCommand}"
                                            CommandParameter="screenshots">
                                        <TextBlock Text="Import" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenPersistFolderCommand}"
                                            CommandParameter="screenshots">
                                        <TextBlock Text="Persist" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </husk:Card>

                        <!-- Logs -->
                        <husk:Card Grid.Row="0" Grid.Column="1">
                            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                                <icons:PackIconLucide Grid.Column="0" Kind="FileText"
                                                      Height="{StaticResource LargeFontSize}"
                                                      Width="{StaticResource LargeFontSize}"
                                                      Foreground="#95A5A6" />
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="Logs" FontWeight="{StaticResource ControlStrongFontWeight}" />
                                    <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}"
                                               FontSize="{StaticResource SmallFontSize}">
                                        <Run
                                            Text="{Binding LogsSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},FallbackValue=0.00}" />
                                        <Run Text="MiB" />
                                        <Run Text="·" />
                                        <Run Text="{Binding LogsCount,FallbackValue=0}" />
                                        <Run Text="files" />
                                    </TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenBuildFolderCommand}"
                                            CommandParameter="logs">
                                        <fi:SymbolIcon Symbol="Folder" FontSize="{StaticResource SmallFontSize}" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenImportFolderCommand}"
                                            CommandParameter="logs">
                                        <TextBlock Text="Import" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenPersistFolderCommand}"
                                            CommandParameter="logs">
                                        <TextBlock Text="Persist" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </husk:Card>

                        <!-- Crash Reports -->
                        <husk:Card Grid.Row="1" Grid.Column="0">
                            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                                <icons:PackIconLucide Grid.Column="0" Kind="TriangleAlert"
                                                      Height="{StaticResource LargeFontSize}"
                                                      Width="{StaticResource LargeFontSize}"
                                                      Foreground="#E74C3C" />
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="Crash Reports"
                                               FontWeight="{StaticResource ControlStrongFontWeight}" />
                                    <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}"
                                               FontSize="{StaticResource SmallFontSize}">
                                        <Run
                                            Text="{Binding CrashReportsSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},FallbackValue=0.00}" />
                                        <Run Text="MiB" />
                                        <Run Text="·" />
                                        <Run Text="{Binding CrashReportsCount,FallbackValue=0}" />
                                        <Run Text="files" />
                                    </TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenBuildFolderCommand}"
                                            CommandParameter="crash-reports">
                                        <fi:SymbolIcon Symbol="Folder" FontSize="{StaticResource SmallFontSize}" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenImportFolderCommand}"
                                            CommandParameter="crash-reports">
                                        <TextBlock Text="Import" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenPersistFolderCommand}"
                                            CommandParameter="crash-reports">
                                        <TextBlock Text="Persist" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </husk:Card>

                        <!-- Config -->
                        <husk:Card Grid.Row="1" Grid.Column="1">
                            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                                <icons:PackIconLucide Grid.Column="0" Kind="Settings"
                                                      Height="{StaticResource LargeFontSize}"
                                                      Width="{StaticResource LargeFontSize}"
                                                      Foreground="#F39C12" />
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="Config" FontWeight="{StaticResource ControlStrongFontWeight}" />
                                    <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}"
                                               FontSize="{StaticResource SmallFontSize}">
                                        <Run
                                            Text="{Binding ConfigSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},FallbackValue=0.00}" />
                                        <Run Text="MiB" />
                                        <Run Text="·" />
                                        <Run Text="{Binding ConfigCount,FallbackValue=0}" />
                                        <Run Text="files" />
                                    </TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenBuildFolderCommand}"
                                            CommandParameter="config">
                                        <fi:SymbolIcon Symbol="Folder" FontSize="{StaticResource SmallFontSize}" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenImportFolderCommand}"
                                            CommandParameter="config">
                                        <TextBlock Text="Import" />
                                    </Button>
                                    <Button Theme="{StaticResource GhostButtonTheme}" Classes="Small"
                                            Command="{Binding OpenPersistFolderCommand}"
                                            CommandParameter="config">
                                        <TextBlock Text="Persist" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </husk:Card>

                        <!-- Other Files -->
                        <husk:Card Grid.Row="2" Grid.Column="0">
                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="12">
                                <icons:PackIconLucide Grid.Column="0" Kind="FolderTree"
                                                      Height="{StaticResource LargeFontSize}"
                                                      Width="{StaticResource LargeFontSize}"
                                                      Foreground="{StaticResource ControlSecondaryForegroundBrush}" />
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="Other Files"
                                               FontWeight="{StaticResource ControlStrongFontWeight}" />
                                    <TextBlock Foreground="{StaticResource ControlSecondaryForegroundBrush}"
                                               FontSize="{StaticResource SmallFontSize}">
                                        <Run
                                            Text="{Binding OtherSize,Mode=OneWay,StringFormat=F2,Converter={x:Static converters:InternalConverters.UnsignedLongToMiBDoubleConverter},FallbackValue=0.00}" />
                                        <Run Text="MiB" />
                                    </TextBlock>
                                </StackPanel>
                            </Grid>
                        </husk:Card>
                    </Grid>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</controls:Subpage>
